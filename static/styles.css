:root{
  --content-max-w: 1000px; /* center column width */
  --header-h: 120px;       /* visual header height */
  --input-h: 88px;         /* bottom input bar height */
  --right-w: 340px;        /* right sidebar width */
  --gap: 16px;
}

/* Keep page from scrolling; panes will handle scrolling */
html, body{ height:100%; }
[data-testid="stAppViewContainer"] .main{ overflow:hidden; }

/* ---------- Center column wrapper (reserves room for right pane) ---------- */
.center-wrap{ padding-right: calc(var(--right-w) + var(--gap)); }
.main-wrap{ max-width: var(--content-max-w); margin: 0 auto; }

/* ---------- Header (sticky) ---------- */
.header-section{
  position: sticky; top: 0; z-index: 5;
  min-height: var(--header-h);
  display:flex; flex-direction:column; justify-content:center;
  text-align:center; padding:20px;
  background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  color:#fff; border-radius:0 0 15px 15px;
}

/* ---------- Chat viewport (only this scrolls) ---------- */
.chat-viewport{ height: calc(100vh - var(--header-h) - var(--input-h)); overflow:hidden; }
.chat-container{ height:100%; overflow-y:auto; padding:20px; display:flex; flex-direction:column; }

/* ---------- Messages ---------- */
.user-message{
  align-self:flex-end; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  color:#fff; padding:15px 20px; border-radius:18px 18px 5px 18px;
  max-width:70%; margin:10px 0; box-shadow:0 4px 6px rgba(0,0,0,.1);
}
.assistant-message{
  align-self:flex-start; background:#f8f9fa; color:#333;
  padding:15px 20px; border-radius:18px 18px 18px 5px; max-width:70%;
  margin:10px 0; border:1px solid #e9ecef; box-shadow:0 2px 4px rgba(0,0,0,.05);
}
.message-header{ display:flex; align-items:center; margin-bottom:5px; font-weight:600; }
.avatar{ width:24px; height:24px; border-radius:50%; margin-right:8px; }
.timestamp{ font-size:.7rem; opacity:.7; margin-top:8px; text-align:right; }

/* ---------- Thinking ---------- */
.thinking-indicator{
  align-self:flex-start; background:#f0f8ff; color:#666;
  padding:10px 20px; border-radius:18px; max-width:260px; margin:10px 0;
  border:1px solid #667eea; font-style:italic;
}
.thinking-dots{ display:inline-flex; gap:4px; margin-left:10px; }
.thinking-dot{ width:6px; height:6px; border-radius:50%; background:#667eea; animation:thinking-bounce 1.4s infinite ease-in-out; }
.thinking-dot:nth-child(1){ animation-delay:-0.32s; } .thinking-dot:nth-child(2){ animation-delay:-0.16s; }
@keyframes thinking-bounce{ 0%,80%,100%{transform:scale(0);} 40%{transform:scale(1);} }

/* ---------- Input bar (fixed bottom) ---------- */
.input-section{
  position: fixed; left:0; right:0; bottom:0; height: var(--input-h);
  background:#fff; border-top:1px solid #e0e0e0; box-shadow:0 -2px 20px rgba(0,0,0,.1);
  z-index:1000; display:flex; align-items:center;
}
.input-container{
  max-width: var(--content-max-w); width:100%; margin:0 auto;
  display:flex; gap:10px; align-items:center; padding:0 15px;
}

/* ---------- Right sidebar (independent scroll) ---------- */
.right-pane{
  position: fixed; top: var(--header-h); right: 0; width: var(--right-w);
  bottom: var(--input-h); padding: 14px; background: #fff;
  border-left: 1px solid #eef0f3; box-shadow: -4px 0 12px rgba(0,0,0,.04);
  overflow-y: auto;
}
.rp-section{ margin-bottom: 16px; }
.rp-title{ font-weight: 700; margin-bottom: 8px; }
.rp-card{ border:1px solid #eef0f3; border-radius:12px; padding:12px; background:#fafbfc; }
.rp-list{ padding-left:18px; margin:6px 0 0 0; }
.rp-chip{ display:inline-block; padding:6px 10px; border-radius:999px; background:#eef2ff; margin:4px 6px 0 0; font-size:.85rem; }

/* ---- Capabilities (moved to right pane) ---- */
.rp-cap-grid{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
.rp-cap-item{
  background:#ebf1ff; border:1px solid #dbe4ff; border-radius:12px;
  padding:10px; text-align:center; font-weight:600;
}
.rp-cap-item:hover{ background:#e5eaff; }

/* ---------- Left sidebar (unchanged) ---------- */
.sidebar-content{ padding:20px; }
.chat-history-item{ padding:10px; margin:5px 0; border-radius:5px; cursor:pointer; transition:background .3s; border:1px solid #e0e0e0; }
.chat-history-item:hover{ background:#f0f0f0; }
.chat-history-item.active{ background:#667eea; color:#fff; border-color:#667eea; }
.upload-section{ background:#f8f9fa; padding:15px; border-radius:10px; margin-bottom:15px; border:1px solid #e0e0e0; }

/* ---------- Buttons ---------- */
.stButton button{
  border-radius:24px; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  color:#fff; border:none; padding:10px 20px; font-weight:600; height:44px;
}

/* ---------- Responsive ---------- */
@media (max-width: 1200px){
  :root{ --right-w: 0px; }
  .center-wrap{ padding-right: 0; }
  .right-pane{ display: none; }
}
@media (max-width: 768px){
  :root{ --content-max-w: 92vw; --header-h: 128px; --input-h: 96px; }
  .user-message, .assistant-message{ max-width:85%; }
}